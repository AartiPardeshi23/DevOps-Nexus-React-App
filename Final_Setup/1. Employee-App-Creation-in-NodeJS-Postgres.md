
# ğŸ“˜ Employee Management Web REST API

**Node.js (UI + API) + PostgreSQL (DB) using Docker**

---

## ğŸ“Œ Project Overview

This project is a **Web REST API application** where:

* **Node.js** is used for:

  * UI (HTML)
  * REST API (CRUD)
* **PostgreSQL** is used as the database
* Both run in **separate Docker containers**
* UI changes are **persisted in the database**

---

## ğŸ—ï¸ Architecture

```
Browser
   |
   v
Node.js (UI + REST API)  ---> PostgreSQL
(Docker Container)          (Docker Container)
```

---

## ğŸ§° Tech Stack

* Node.js (Express)
* PostgreSQL
* Docker
* Docker Compose
* HTML + JavaScript

---

## ğŸ“‚ Project Structure

```
employee-app/
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ backend/
    â”œâ”€â”€ Dockerfile
    â”œâ”€â”€ package.json
    â”œâ”€â”€ server.js
    â”œâ”€â”€ db.js
    â””â”€â”€ frontend/
        â””â”€â”€ index.html
```

---

## âš™ï¸ Prerequisites (VM / Local Machine)

```bash
docker --version
docker-compose --version
```

If not installed â†’ install Docker & Docker Compose first.

---

## ğŸš€ Step-by-Step Setup & Run

---

### ğŸ”¹ STEP 1: Create Project Directories (VM)

```bash
mkdir -p employee-app/backend/frontend
cd employee-app
```

---

### ğŸ”¹ STEP 2: Docker Compose File

ğŸ“„ `docker-compose.yml`

```yaml
version: "3.8"

services:
  postgres:
    image: postgres:15
    container_name: employee-postgres
    environment:
      POSTGRES_DB: employeedb
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: admin123
    ports:
      - "5432:5432"
    volumes:
      - pgdata:/var/lib/postgresql/data

  nodeapp:
    build: ./backend
    container_name: employee-nodeapp
    ports:
      - "3000:3000"
    depends_on:
      - postgres
    environment:
      DB_HOST: postgres
      DB_USER: admin
      DB_PASSWORD: admin123
      DB_NAME: employeedb
      DB_PORT: 5432

volumes:
  pgdata:
```

---

### ğŸ”¹ STEP 3: Node.js Backend Files

#### ğŸ“„ `backend/package.json`

```json
{
  "name": "employee-app",
  "version": "1.0.0",
  "main": "server.js",
  "scripts": {
    "start": "node server.js"
  },
  "dependencies": {
    "express": "^4.18.2",
    "pg": "^8.11.3",
    "body-parser": "^1.20.2"
  }
}
```

---

#### ğŸ“„ `backend/db.js`

```js
const { Pool } = require("pg");

const pool = new Pool({
  host: process.env.DB_HOST,
  user: process.env.DB_USER,
  password: process.env.DB_PASSWORD,
  database: process.env.DB_NAME,
  port: process.env.DB_PORT,
});

module.exports = pool;
```

---

#### ğŸ“„ `backend/server.js`

```js
const express = require("express");
const bodyParser = require("body-parser");
const path = require("path");
const pool = require("./db");

const app = express();
app.use(bodyParser.json());

app.use(express.static(path.join(__dirname, "frontend")));

app.get("/", (req, res) => {
  res.sendFile(path.join(__dirname, "frontend", "index.html"));
});

pool.query(`
  CREATE TABLE IF NOT EXISTS employees (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    role VARCHAR(100)
  );
`);

app.post("/employees", async (req, res) => {
  const { name, role } = req.body;
  const result = await pool.query(
    "INSERT INTO employees (name, role) VALUES ($1, $2) RETURNING *",
    [name, role]
  );
  res.json(result.rows[0]);
});

app.get("/employees", async (req, res) => {
  const result = await pool.query("SELECT * FROM employees");
  res.json(result.rows);
});

app.delete("/employees/:id", async (req, res) => {
  await pool.query("DELETE FROM employees WHERE id=$1", [req.params.id]);
  res.send("Deleted");
});

app.listen(3000, () => {
  console.log("Node app running on port 3000");
});
```

---

### ğŸ”¹ STEP 4: Frontend UI

ğŸ“„ `backend/frontend/index.html`

```html
<!DOCTYPE html>
<html>
<head>
  <title>Employee Management</title>
</head>
<body>
  <h2>Employee Management</h2>

  <input id="name" placeholder="Name">
  <input id="role" placeholder="Role">
  <button onclick="addEmployee()">Add</button>

  <ul id="list"></ul>

<script>
async function loadEmployees() {
  const res = await fetch("/employees");
  const data = await res.json();
  const list = document.getElementById("list");
  list.innerHTML = "";
  data.forEach(e => {
    list.innerHTML += `<li>${e.name} - ${e.role}
      <button onclick="deleteEmployee(${e.id})">Delete</button>
    </li>`;
  });
}

async function addEmployee() {
  const name = document.getElementById("name").value;
  const role = document.getElementById("role").value;
  await fetch("/employees", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, role })
  });
  loadEmployees();
}

async function deleteEmployee(id) {
  await fetch(`/employees/${id}`, { method: "DELETE" });
  loadEmployees();
}

loadEmployees();
</script>
</body>
</html>
```

---

### ğŸ”¹ STEP 5: Dockerfile

ğŸ“„ `backend/Dockerfile`

```dockerfile
FROM node:18

WORKDIR /app

COPY package.json .
RUN npm install

COPY . .

EXPOSE 3000
CMD ["npm", "start"]
```

---

## â–¶ï¸ STEP 6: Build & Run Containers (VM)

```bash
docker-compose down
docker-compose up --build -d
```

---

## ğŸ” STEP 7: Verify Containers

```bash
docker ps
```

Expected:

```
employee-nodeapp
employee-postgres
```

---

## ğŸŒ STEP 8: Access UI (Browser)

```
http://<VM-IP>:3000
```

---

## ğŸ—„ï¸ STEP 9: Verify Database Data

```bash
docker exec -it employee-postgres psql -U admin -d employeedb
```

Inside psql:

```sql
\dt
SELECT * FROM employees;
\q
```

OR one-liner:

```bash
docker exec -it employee-postgres psql -U admin -d employeedb -c "SELECT * FROM employees;"
```

---

## âœ… Expected Result

* âœ” UI loads
* âœ” Add employee â†’ stored in DB
* âœ” Delete employee â†’ removed from DB
* âœ” Containers isolated
* âœ” Fully Dockerized

---

## âš ï¸ Common Issues & Fixes

| Issue                | Fix                                    |
| -------------------- | -------------------------------------- |
| Cannot GET /         | Ensure `index.html` served via Express |
| Node container exits | Check `docker logs employee-nodeapp`   |
| YAML error           | Use spaces, not tabs                   |
| DB not connecting    | Use service name `postgres`            |

---

## ğŸ¯ Status

**PART-1 COMPLETE** âœ…
Node.js + PostgreSQL CRUD app running successfully.

---


## ğŸ‘‰ Next (As per architecture diagram)

**PART-2**

* GitHub repo
* Build pipeline
* Nexus artifact storage
* Nginx web server
* Burp Suite security testing

---
